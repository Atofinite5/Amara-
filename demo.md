# Amara Demo Script

## 1. Introduction
"Hi, this is the demo for Amara Day-2. We've upgraded the system from a simple file watcher to a comprehensive intelligence and security daemon."

## 2. Architecture Overview
- **Core**: File watcher + Rule Engine (Regex/LLM)
- **Intelligence**: CodeFusion Engine (Static Analysis + Fixes)
- **Security**: Redis-backed JWT Auth & Rate Limiting
- **Cloud**: Real-time sync with Supabase

## 3. Feature Demos

### A. CodeFusion (Intelligence)
1. **Scenario**: I have a TypeScript file with a type error.
2. **Action**: `POST /api/analyze` with `{ filePath: "src/bad.ts", suggestFix: true }`
3. **Result**: API returns the diagnostic error AND a code patch generated by the LLM.

### B. Security & Auth
1. **Scenario**: Accessing `/api/rules` without a token.
2. **Result**: 401 Unauthorized.
3. **Action**: Login via `/auth/login` -> Get Access/Refresh Tokens.
4. **Action**: Access `/api/rules` with Bearer token -> 200 OK.
5. **Action**: Token rotation via `/auth/refresh`.

### C. Cloud Sync
1. **Scenario**: A rule is added in the Supabase Dashboard.
2. **Result**: Amara daemon receives the realtime update via WebSocket and hot-reloads the rule without restart.
3. **Scenario**: A local file match occurs.
4. **Result**: The event is pushed to Supabase `events` table immediately.

## 4. Scalability & Limitations
- **Works well**: Single-node monitoring, medium codebases (<10k files).
- **Breaks at scale**: 
  - `chokidar` on huge monorepos can consume high CPU.
  - SQLite write locks if thousands of events trigger per second.
  - Redis memory usage if token blacklist grows indefinitely (though we have TTL).

## 5. Conclusion
"Amara is now a production-ready, secure, and intelligent guardian for your codebase."
